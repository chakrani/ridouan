
    <div id="vid-controls">
      <video id="vid-show" autoplay style='display:none'></video>
      <input id="vid-take" type="button" value="Take Photo"/>
      <div id="vid-canvas"></div>
    </div>
<script>
if (!HTMLCanvasElement.prototype.toBlob) {
   Object.defineProperty(HTMLCanvasElement.prototype, 'toBlob', {
     value: function (callback, type, quality) {
       var canvas = this;
       setTimeout(function() {
         var binStr = atob( canvas.toDataURL(type, quality).split(',')[1] ),
         len = binStr.length,
         arr = new Uint8Array(len);

         for (var i = 0; i < len; i++ ) {
            arr[i] = binStr.charCodeAt(i);
         }

         callback( new Blob( [arr], {type: type || 'image/jpeg'} ) );
       });
     }
  });
}


function dopm(){
sa=document.getElementById('plaatje');
sa.src='fo/uploaded.png?v='+Math.random();

}
function sop(){
ec=document.getElementById("vid-take");
ec.click();

//setTimeout("dop()", 500);
}


window.addEventListener("load", function(){
  // [1] GET ALL THE HTML ELEMENTS
  var video = document.getElementById("vid-show"),
      canvas = document.getElementById("vid-canvas"),
      take = document.getElementById("vid-take");

  // [2] ASK FOR USER PERMISSION TO ACCESS CAMERA
  // WILL FAIL IF NO CAMERA IS ATTACHED TO COMPUTER
  navigator.mediaDevices.getUserMedia({ video : true })
  .then(function(stream) {
    // [3] SHOW VIDEO STREAM ON VIDEO TAG
    video.srcObject = stream;
    video.play();

    // [4] WHEN WE CLICK ON "TAKE PHOTO" BUTTON
    take.addEventListener("click", function(){
      // Create snapshot from video
      var draw = document.createElement("canvas");
      draw.width = video.videoWidth;
      draw.height = video.videoHeight;
      var context2D = draw.getContext("2d");
      context2D.drawImage(video, 0, 0, video.videoWidth, video.videoHeight);
context2D.canvas.toBlob(function (blob) {
 console.log(blob); //access blob here
 }, 'image/jpeg', .25);

      // Upload to server
      draw.toBlob(function(blob){
        var data = new FormData();
        data.append('upimage', blob);
        var xhr = new XMLHttpRequest();
        xhr.open('POST', "3-upload.php", true);
        xhr.onload = function(){
          if (xhr.status==403 || xhr.status==404) {
            alert("ERROR LOADING 3-UPLOAD.PHP");
          } else {
		document.title="a"+Math.random();
		dopm();
		sop();
        //    alert(this.response);
          }
        };
        xhr.send(data);
      });
    });
  })
  .catch(function(err) {
    document.getElementById("vid-controls").innerHTML = "Please enable access and attach a camera";
  });
});

</script>

<script>


function dop(){
ec=document.getElementById("vid-take");
ec.click();

//setTimeout("dop()", 500);
}


</script>
<img src='fo/uploaded.png' id='plaatje'  style='width:350px;height:200px'>
<script>
//dop();

function nets(){
sa=document.getElementById('plaatje');
sa.src='fo/uploaded.png';
}


dop();

</script>
